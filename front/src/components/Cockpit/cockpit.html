<div id="Cockpit">
    <md-toolbar class="justifyTitleBtn">
        <h1>Cockpit</h1>
        <md-button class="md-raised md-accent" v-if="newAffaireAllowed" @click="$router.push({name: 'NewAffaire'})">Nouvelle affaire</md-button>
    </md-toolbar>

    <div v-if="showMatdiff">
        <Matdiff />
    </div>

    <md-card>
        <md-card-content>

            <div style="display: flex;">
                <md-field style="width: 250px !important;">
                    <label>Rechercher</label>
                    <md-input v-model="searchAffaire" placeholder="Nom d'affaire" v-on:keyup="updateTable"></md-input>
                </md-field>

                <md-field style="margin-left: 50px; width: 250px !important;">
                    <label for="operateur">Opérateur</label>
                    <md-select v-model="selectedOperateur" name="operateur" id="operateur" @md-selected="updateTable" md-dense>
                      <md-option :value="-1">Tous</md-option>
                      <md-option v-for="item in operateurs" :value="item.id">{{ item.nom }}</md-option>
                    </md-select>
                  </md-field>

                <md-checkbox v-model="showFinProcessus" @change="updateTable" style="margin-left: 50px; margin-top:25px;">Afficher l'étape fin de processus</md-checkbox>

                <p style="margin-top: 25px;">({{ affaires.length }} affaires)</p>
            </div>
            
            <md-progress-bar md-mode="indeterminate" v-if="loadingAffaires"></md-progress-bar>
            <md-table v-model="affaires" md-sort="id" md-sort-order="desc" md-card>
                <md-table-row slot="md-table-row" slot-scope="{ item }">
                    <md-table-cell style="width: 5%;" md-sort-by="affaire_type" md-label="Type d'affaire">{{ item.affaire_type }}</md-table-cell>
                    <md-table-cell style="width: 5%;" md-sort-by="dashboard_0" md-label="Coordination (DGY)"><md-button class="md-raised" @click="openAffaire(item)" v-if="item.dashboard_0">{{ item.dashboard_0 }}</md-button></md-table-cell>
                    <md-table-cell style="width: 5%;" md-sort-by="dashboard_1" md-label="Travaux (c. éq.)"><md-button class="md-raised" @click="openAffaire(item)" v-if="item.dashboard_1">{{ item.dashboard_1 }}</md-button></md-table-cell>
                    <md-table-cell style="width: 5%;" md-sort-by="dashboard_2" md-label="Ctrl tech (DGY)"><md-button class="md-raised" @click="openAffaire(item)" v-if="item.dashboard_2">{{ item.dashboard_2 }}</md-button></md-table-cell>
                    <md-table-cell style="width: 5%;" md-sort-by="dashboard_3" md-label="Report serv. (BB)"><md-button class="md-raised" @click="openAffaire(item)" v-if="item.dashboard_3">{{ item.dashboard_3 }}</md-button></md-table-cell>
                    <md-table-cell style="width: 5%;" md-sort-by="dashboard_4" md-label="1er ctrl (LF/FS)"><md-button class="md-raised" @click="openAffaire(item)" v-if="item.dashboard_4">{{ item.dashboard_4 }}</md-button></md-table-cell>
                    <md-table-cell style="width: 5%;" md-sort-by="dashboard_5" md-label="Prép. doc. final (PDE/SE)"><md-button class="md-raised" @click="openAffaire(item)" v-if="item.dashboard_5">{{ item.dashboard_5 }}</md-button></md-table-cell>
                    <md-table-cell style="width: 5%;" md-sort-by="dashboard_6" md-label="2e ctrl (LF/FS)"><md-button class="md-raised" @click="openAffaire(item)" v-if="item.dashboard_6">{{ item.dashboard_6 }}</md-button></md-table-cell>
                    <md-table-cell style="width: 5%;" md-sort-by="dashboard_7" md-label="Finalisation (PDE/SE)"><md-button class="md-raised" @click="openAffaire(item)" v-if="item.dashboard_7">{{ item.dashboard_7 }}</md-button></md-table-cell>
                    <md-table-cell style="width: 5%;" md-sort-by="dashboard_9" md-label="Signatures-Art.35 (LF/FS)"><md-button class="md-raised" @click="openAffaire(item)" v-if="item.dashboard_9">{{ item.dashboard_9 }}</md-button></md-table-cell>
                    <md-table-cell style="width: 5%;" md-sort-by="dashboard_8" md-label="Valid tech (DGY)"><md-button class="md-raised" @click="openAffaire(item)" v-if="item.dashboard_8">{{ item.dashboard_8 }}</md-button></md-table-cell>
                    <md-table-cell style="width: 5%;" md-sort-by="dashboard_10" md-label="Fin de processus  (<30 j>)" v-if="showFinProcessus"><md-button class="md-raised" @click="openAffaire(item)" v-if="item.dashboard_10">{{ item.dashboard_10 }}</md-button></md-table-cell>
                </md-table-row>
            </md-table>

        </md-card-content>
    </md-card>

</div>

